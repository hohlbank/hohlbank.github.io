<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hohl Bank - –í—Ö–æ–¥</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            min-height: 100vh;
            color: #fff;
        }
        
        .container {
            background: #2d2d2d;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            max-width: 400px;
            width: 100%;
            margin: 50px auto;
        }
        
        .container.wide { max-width: 1400px; }
        
        .header {
            background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
            padding: 40px 30px;
            text-align: center;
            color: white;
            border-bottom: 2px solid #3d3d3d;
        }
        
        .logo { font-size: 48px; margin-bottom: 10px; }
        .header h1 { font-size: 32px; font-weight: 700; margin-bottom: 5px; }
        .header p { font-size: 14px; opacity: 0.7; }
        
        .form-container { padding: 40px 30px; }
        .form-group { margin-bottom: 25px; }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #fff;
            font-weight: 500;
            font-size: 14px;
        }
        
        .form-group input, input[type="text"], input[type="password"], input[type="number"], textarea, select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #3d3d3d;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #1a1a1a;
            color: #fff;
        }
        
        .form-group input:focus, input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #5a9fd4;
            box-shadow: 0 0 0 3px rgba(90, 159, 212, 0.2);
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #5a9fd4 0%, #4a8fc4 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(90, 159, 212, 0.4);
        }
        
        .btn:active { transform: translateY(0); }
        
        .btn-primary { background: #5a9fd4; }
        .btn-danger { background: #dc3545; }
        .btn-secondary { background: #6c757d; }
        .btn-success { background: #28a745; }
        
        .message {
            margin-top: 20px;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-size: 14px;
            display: none;
        }
        
        .message.success {
            background: rgba(40, 167, 69, 0.2);
            color: #4caf50;
            border: 1px solid #4caf50;
        }
        
        .message.error {
            background: rgba(220, 53, 69, 0.2);
            color: #f44336;
            border: 1px solid #f44336;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-tabs {
            display: flex;
            background: #1a1a1a;
            border-bottom: 2px solid #3d3d3d;
            padding: 0 20px;
        }
        
        .nav-tab {
            padding: 15px 30px;
            background: none;
            border: none;
            color: #999;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .nav-tab:hover { color: #5a9fd4; }
        .nav-tab.active { color: #fff; }
        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #5a9fd4;
        }
        
        .dashboard { display: none; }
        .dashboard-content { display: none; padding: 40px; }
        .dashboard-content.active { display: block; }
        
        /* –ë–∞–Ω–∫ */
        .dashboard-layout {
            display: grid;
            grid-template-columns: 1fr 450px;
            gap: 30px;
        }
        
        .left-section, .right-section {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .user-info, .card-section, .transfer-section, .notifications-section {
            background: #1a1a1a;
            padding: 30px;
            border-radius: 15px;
            border: 1px solid #3d3d3d;
        }
        
        h3 { color: #fff; margin-bottom: 20px; font-size: 20px; }
        
        .bank-card {
            background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
            border-radius: 15px;
            padding: 25px;
            color: white;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
            border: 1px solid #3d3d3d;
        }
        
        .bank-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(90, 159, 212, 0.1) 0%, transparent 70%);
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            position: relative;
            z-index: 1;
        }
        
        .card-logo { font-size: 32px; }
        .card-type {
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 2px;
            opacity: 0.9;
        }
        
        .card-chip {
            width: 50px;
            height: 40px;
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            border-radius: 8px;
            margin-bottom: 25px;
            position: relative;
            z-index: 1;
        }
        
        .card-number {
            font-size: 22px;
            letter-spacing: 3px;
            margin-bottom: 20px;
            font-weight: 500;
            position: relative;
            z-index: 1;
        }
        
        .card-footer {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            position: relative;
            z-index: 1;
        }
        
        .card-info div {
            margin-bottom: 5px;
        }
        
        .card-label {
            font-size: 10px;
            opacity: 0.7;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .card-value {
            font-size: 16px;
            font-weight: 600;
        }
        
        .card-balance {
            font-size: 32px;
            font-weight: 700;
            text-align: right;
        }
        
        .card-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .card-actions button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .transaction-item {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #3d3d3d;
        }
        
        .transaction-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        
        .transaction-type {
            font-weight: 600;
            font-size: 14px;
        }
        
        .transaction-amount {
            font-weight: 700;
            font-size: 16px;
        }
        
        .transaction-amount.positive { color: #4caf50; }
        .transaction-amount.negative { color: #f44336; }
        
        .transaction-details {
            font-size: 12px;
            opacity: 0.7;
        }
        
        .notification-item {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #5a9fd4;
        }
        
        .notification-item.success { border-left-color: #4caf50; }
        .notification-item.error { border-left-color: #f44336; }
        .notification-item.warning { border-left-color: #ff9800; }
        
        .notification-message {
            margin-bottom: 5px;
            font-size: 14px;
        }
        
        .notification-date {
            font-size: 11px;
            opacity: 0.6;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px;
            opacity: 0.5;
        }
        
        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        /* –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä */
        .messenger-layout {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
            height: 600px;
        }
        
        .chats-list, .chat-window {
            background: #1a1a1a;
            border-radius: 15px;
            border: 1px solid #3d3d3d;
            overflow: hidden;
        }
        
        .chats-list {
            display: flex;
            flex-direction: column;
        }
        
        .chats-header {
            padding: 20px;
            border-bottom: 1px solid #3d3d3d;
        }
        
        .chats-search input {
            width: 100%;
            padding: 10px;
            background: #2d2d2d;
            border: 1px solid #3d3d3d;
            border-radius: 8px;
            color: #fff;
            margin-top: 10px;
        }
        
        .chats-items {
            flex: 1;
            overflow-y: auto;
        }
        
        .chat-item {
            padding: 15px 20px;
            border-bottom: 1px solid #3d3d3d;
            cursor: pointer;
            transition: background 0.2s ease;
        }
        
        .chat-item:hover { background: #2d2d2d; }
        .chat-item.active { background: #2d2d2d; }
        
        .chat-item-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .chat-item-name {
            font-weight: 600;
            font-size: 14px;
        }
        
        .chat-item-time {
            font-size: 11px;
            opacity: 0.6;
        }
        
        .chat-item-preview {
            font-size: 13px;
            opacity: 0.7;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .chat-window {
            display: flex;
            flex-direction: column;
        }
        
        .chat-header {
            padding: 20px;
            border-bottom: 1px solid #3d3d3d;
        }
        
        .chat-user-name {
            font-weight: 600;
            font-size: 16px;
        }
        
        .chat-user-status {
            font-size: 12px;
            opacity: 0.6;
            margin-top: 3px;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .message {
            max-width: 70%;
            padding: 10px 15px;
            border-radius: 15px;
            word-wrap: break-word;
        }
        
        .message.sent {
            align-self: flex-end;
            background: #5a9fd4;
            color: white;
            border-bottom-right-radius: 5px;
        }
        
        .message.received {
            align-self: flex-start;
            background: #2d2d2d;
            border-bottom-left-radius: 5px;
        }
        
        .message-text {
            margin-bottom: 5px;
        }
        
        .message-time {
            font-size: 10px;
            opacity: 0.7;
            text-align: right;
        }
        
        .chat-input-container {
            padding: 20px;
            border-top: 1px solid #3d3d3d;
            display: flex;
            gap: 10px;
        }
        
        .chat-input-container input {
            flex: 1;
        }
        
        .chat-input-container button {
            width: auto;
            padding: 12px 30px;
        }
        
        /* –ü–æ—Å—Ç—ã */
        .posts-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .posts-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .post-card {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 25px;
            border: 1px solid #3d3d3d;
        }
        
        .post-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .post-author {
            font-weight: 600;
            font-size: 16px;
        }
        
        .post-date {
            font-size: 12px;
            opacity: 0.6;
        }
        
        .post-content {
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .post-actions {
            display: flex;
            gap: 10px;
            padding-top: 15px;
            border-top: 1px solid #3d3d3d;
        }
        
        .post-action-btn {
            background: none;
            border: none;
            color: #999;
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 5px;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .post-action-btn:hover {
            background: #2d2d2d;
            color: #fff;
        }
        
        .post-action-btn.liked {
            color: #f44336;
        }
        
        .create-post {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid #3d3d3d;
        }
        
        .create-post textarea {
            width: 100%;
            min-height: 100px;
            margin-bottom: 15px;
            resize: vertical;
        }
        
        /* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ */
        .settings-section {
            background: #1a1a1a;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid #3d3d3d;
        }
        
        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #3d3d3d;
        }
        
        .setting-item:last-child { border-bottom: none; }
        
        .setting-label {
            font-weight: 500;
        }
        
        .setting-description {
            font-size: 12px;
            opacity: 0.6;
            margin-top: 3px;
        }
        
        .toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
            background: #3d3d3d;
            border-radius: 13px;
            cursor: pointer;
            transition: background 0.3s ease;
        }
        
        .toggle-switch.active { background: #5a9fd4; }
        
        .toggle-switch::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            transition: left 0.3s ease;
        }
        
        .toggle-switch.active::after { left: 27px; }
        
        .login-history-item {
            background: #2d2d2d;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border: 1px solid #3d3d3d;
        }
        
        /* –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å */
        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: #1a1a1a;
            padding: 25px;
            border-radius: 15px;
            border: 1px solid #3d3d3d;
        }
        
        .stat-value {
            font-size: 36px;
            font-weight: 700;
            color: #5a9fd4;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.7;
        }
        
        .users-table {
            width: 100%;
            background: #1a1a1a;
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid #3d3d3d;
        }
        
        .users-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .users-table th {
            background: #0d0d0d;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            border-bottom: 1px solid #3d3d3d;
        }
        
        .users-table td {
            padding: 15px;
            border-bottom: 1px solid #3d3d3d;
        }
        
        .users-table tr:last-child td { border-bottom: none; }
        
        .users-table tr:hover { background: #2d2d2d; }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .action-buttons button {
            padding: 6px 12px;
            font-size: 12px;
            width: auto;
        }
        
        .admin-only { display: none; }
        
        @media (max-width: 1200px) {
            .dashboard-layout {
                grid-template-columns: 1fr;
            }
            
            .messenger-layout {
                grid-template-columns: 1fr;
                height: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="mainContainer">
        <div class="header">
            <div class="logo">üè¶</div>
            <h1>Hohl Bank</h1>
            <p id="headerSubtitle">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</p>
        </div>

        <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
        <div id="loginForm">
            <div class="form-container">
                <div class="form-group">
                    <label for="username">–õ–æ–≥–∏–Ω</label>
                    <input type="text" id="username" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω" autocomplete="username">
                </div>
                <div class="form-group">
                    <label for="password">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="password" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" autocomplete="current-password">
                </div>
                <button class="btn" onclick="handleLogin()">–í–æ–π—Ç–∏</button>
                <button class="btn btn-secondary" style="margin-top: 10px;" onclick="handleRegister()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                <div class="message" id="message"></div>
            </div>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="dashboard">
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchSection('bank')">üí≥ –ë–∞–Ω–∫</button>
                <button class="nav-tab" onclick="switchSection('messenger')">üí¨ –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä</button>
                <button class="nav-tab" onclick="switchSection('posts')">üìù –ü–æ—Å—Ç—ã</button>
                <button class="nav-tab" onclick="switchSection('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
                <button class="nav-tab admin-only" onclick="switchSection('admin')">üëë –ê–¥–º–∏–Ω</button>
            </div>

            <!-- –ë–∞–Ω–∫ -->
            <div id="bankSection" class="dashboard-content active">
                <div class="dashboard-layout">
                    <div class="left-section">
                        <div class="user-info">
                            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ</h3>
                            <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, <strong id="displayName"></strong>!</p>
                            <p style="margin-top: 10px; opacity: 0.7; font-size: 14px;">–õ–æ–≥–∏–Ω: <span id="usernameDisplay"></span></p>
                            <button class="btn btn-danger" style="margin-top: 20px;" onclick="handleLogout()">–í—ã–π—Ç–∏</button>
                        </div>

                        <div class="card-section">
                            <h3>–ú–æ—è –∫–∞—Ä—Ç–∞</h3>
                            <div id="cardContainer"></div>
                        </div>
                    </div>

                    <div class="right-section">
                        <div class="transfer-section">
                            <h3>–ü–µ—Ä–µ–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</h3>
                            <div class="form-group">
                                <label for="recipientCard">–ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã –ø–æ–ª—É—á–∞—Ç–µ–ª—è</label>
                                <input type="text" id="recipientCard" placeholder="0000 0000 0000 0000" maxlength="19">
                            </div>
                            <div class="form-group">
                                <label for="transferAmount">–°—É–º–º–∞</label>
                                <input type="number" id="transferAmount" placeholder="0.00" step="0.01" min="0">
                            </div>
                            <button class="btn" onclick="handleTransfer()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        </div>

                        <div class="notifications-section">
                            <h3>–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h3>
                            <div id="notificationsList"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä -->
            <div id="messengerSection" class="dashboard-content">
                <div class="messenger-layout">
                    <div class="chats-list">
                        <div class="chats-header">
                            <h3 style="margin-bottom: 0;">–ß–∞—Ç—ã</h3>
                            <div class="chats-search">
                                <input type="text" id="chatSearch" placeholder="–ü–æ–∏—Å–∫..." onkeyup="filterChats()">
                            </div>
                        </div>
                        <div class="chats-items" id="chatsList"></div>
                    </div>

                    <div class="chat-window">
                        <div class="chat-header" id="chatHeader" style="display: none;">
                            <div class="chat-user-name" id="chatUserName"></div>
                            <div class="chat-user-status">–û–Ω–ª–∞–π–Ω</div>
                        </div>
                        <div class="chat-messages" id="chatMessages">
                            <div class="empty-state">
                                <div class="empty-state-icon">üí¨</div>
                                <div>–í—ã–±–µ—Ä–∏—Ç–µ —á–∞—Ç –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è</div>
                            </div>
                        </div>
                        <div class="chat-input-container" id="chatInputContainer" style="display: none;">
                            <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                            <button class="btn" onclick="sendMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ü–æ—Å—Ç—ã -->
            <div id="postsSection" class="dashboard-content">
                <div class="posts-header">
                    <h3 style="margin-bottom: 0;">–õ–µ–Ω—Ç–∞ –ø–æ—Å—Ç–æ–≤</h3>
                    <button class="btn" style="width: auto; padding: 10px 20px;" onclick="toggleCreatePost()">–°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç</button>
                </div>

                <div class="create-post" id="createPostForm" style="display: none;">
                    <h3>–ù–æ–≤—ã–π –ø–æ—Å—Ç</h3>
                    <textarea id="postContent" placeholder="–û —á–µ–º –≤—ã –¥—É–º–∞–µ—Ç–µ?"></textarea>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-success" onclick="createPost()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
                        <button class="btn btn-secondary" onclick="toggleCreatePost()">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </div>

                <div class="posts-container" id="postsContainer"></div>
            </div>

            <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
            <div id="settingsSection" class="dashboard-content">
                <div class="settings-section">
                    <h3>–ü—Ä–æ—Ñ–∏–ª—å</h3>
                    <div class="form-group">
                        <label for="newDisplayName">–û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è</label>
                        <input type="text" id="newDisplayName" placeholder="–í–≤–µ–¥–∏—Ç–µ –∏–º—è">
                    </div>
                    <button class="btn" onclick="updateDisplayName()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>

                <div class="settings-section">
                    <h3>–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</h3>
                    <div class="form-group">
                        <label for="currentPassword">–¢–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="currentPassword" autocomplete="current-password">
                    </div>
                    <div class="form-group">
                        <label for="newPassword">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="newPassword" autocomplete="new-password">
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                        <input type="password" id="confirmPassword" autocomplete="new-password">
                    </div>
                    <button class="btn" onclick="changePassword()">–ò–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å</button>
                </div>

                <div class="settings-section">
                    <h3>–ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤</h3>
                    <div id="loginHistoryContainer"></div>
                </div>

                <div class="settings-section">
                    <h3>–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h3>
                    <div id="allTransactionsContainer"></div>
                </div>
            </div>

            <!-- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
            <div id="adminSection" class="dashboard-content">
                <div class="admin-stats">
                    <div class="stat-card">
                        <div class="stat-value" id="totalUsers">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalBalance">0 √ê</div>
                        <div class="stat-label">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="totalTransfers">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–æ–≤</div>
                    </div>
                </div>

                <div class="settings-section">
                    <h3>–û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ</h3>
                    <div class="form-group">
                        <label for="notificationType">–¢–∏–ø</label>
                        <select id="notificationType">
                            <option value="info">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</option>
                            <option value="success">–£—Å–ø–µ—Ö</option>
                            <option value="warning">–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</option>
                            <option value="error">–û—à–∏–±–∫–∞</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="notificationRecipient">–ü–æ–ª—É—á–∞—Ç–µ–ª—å</label>
                        <select id="notificationRecipient">
                            <option value="all">–í—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="notificationText">–¢–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</label>
                        <textarea id="notificationText" rows="3"></textarea>
                    </div>
                    <button class="btn" onclick="sendNotification()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>

                <div class="settings-section">
                    <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h3>
                    <div class="users-table">
                        <table>
                            <thead>
                                <tr>
                                    <th>–õ–æ–≥–∏–Ω</th>
                                    <th>–ò–º—è</th>
                                    <th>–ë–∞–ª–∞–Ω—Å</th>
                                    <th>–ü–æ—Å—Ç—ã</th>
                                    <th>–õ–°</th>
                                    <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                </tr>
                            </thead>
                            <tbody id="usersTableBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 
    ============================================
    –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ù–ê–°–¢–†–û–ô–ö–ï FIREBASE
    ============================================
    
    1. –ó–∞–º–µ–Ω–∏—Ç–µ –í–ê–®–ò –¥–∞–Ω–Ω—ã–µ –≤ firebaseConfig –Ω–∏–∂–µ:
       - apiKey: –≤–∞—à API –∫–ª—é—á
       - authDomain: –≤–∞—à –¥–æ–º–µ–Ω
       - databaseURL: URL –≤–∞—à–µ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
       - projectId: ID –ø—Ä–æ–µ–∫—Ç–∞
       - storageBucket: –±–∞–∫–µ—Ç –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è
       - messagingSenderId: ID –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
       - appId: ID –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
    
    2. –í Firebase Console –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ Realtime Database > Rules
    
    3. –í—Å—Ç–∞–≤—å—Ç–µ —ç—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞ –∏ –æ–ø—É–±–ª–∏–∫—É–π—Ç–µ:
    
    {
      "rules": {
        ".read": true,
        ".write": true
      }
    }
    
    ============================================
    -->
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script>
        // ============================================
        // –í–°–¢–ê–í–¨–¢–ï –°–Æ–î–ê –í–ê–®–ò –î–ê–ù–ù–´–ï –ò–ó FIREBASE
        // ============================================
        const firebaseConfig = {
  apiKey: "AIzaSyAQMCpOIf5eJYzD0ACbM8ZnfzNItjN8PZA",
  authDomain: "hohlbank.firebaseapp.com",
  databaseURL: "https://hohlbank-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "hohlbank",
  storageBucket: "hohlbank.firebasestorage.app",
  messagingSenderId: "792378699838",
  appId: "1:792378699838:web:4ab670b39a7f9bd550a16f",
  measurementId: "G-9GYXV82D06"
};

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        let currentUsername = '';
        let isAdmin = false;
        let currentChatUser = '';
        let currentSection = 'bank';
        let balanceVisible = false;
        let titleStage = '–í—Ö–æ–¥';

        async function handleLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const messageEl = document.getElementById('message');

            if (!username || !password) {
                showMessage('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }

            try {
                const snapshot = await database.ref('users/' + username).once('value');
                
                if (!snapshot.exists()) {
                    showMessage('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω', 'error');
                    return;
                }

                const userData = snapshot.val();
                
                if (userData.password !== password) {
                    showMessage('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å', 'error');
                    return;
                }

                currentUsername = username;
                isAdmin = userData.isAdmin === true;
                
                await database.ref('loginHistory/' + username).push({
                    timestamp: new Date().toISOString(),
                    ip: 'Web Client'
                });

                localStorage.setItem('hohlgramSession', JSON.stringify({
                    username: username,
                    timestamp: Date.now()
                }));

                showDashboard();
                loadUserData();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
                showMessage('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞', 'error');
            }
        }

        async function handleRegister() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();

            if (!username || !password) {
                showMessage('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }

            if (username.length < 3) {
                showMessage('–õ–æ–≥–∏–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 3 —Å–∏–º–≤–æ–ª–∞', 'error');
                return;
            }

            if (password.length < 6) {
                showMessage('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                return;
            }

            try {
                const snapshot = await database.ref('users/' + username).once('value');
                
                if (snapshot.exists()) {
                    showMessage('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç', 'error');
                    return;
                }

                await database.ref('users/' + username).set({
                    password: password,
                    displayName: username,
                    createdAt: new Date().toISOString(),
                    isAdmin: false,
                    canPost: true,
                    canDM: true
                });

                const cardNumber = generateCardNumber();
                await database.ref('cards/' + username).set({
                    number: cardNumber,
                    balance: 1000,
                    holder: username,
                    expiry: '12/28',
                    cvv: Math.floor(Math.random() * 900) + 100
                });

                await database.ref('cardHistory/' + username).push({
                    cardNumber: cardNumber,
                    createdAt: new Date().toISOString()
                });

                showMessage('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É', 'success');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
                showMessage('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏', 'error');
            }
        }

        function generateCardNumber() {
            let number = '4276 ';
            for (let i = 0; i < 3; i++) {
                number += Math.floor(1000 + Math.random() * 9000) + ' ';
            }
            return number.trim();
        }

        function showMessage(text, type) {
            const messageEl = document.getElementById('message');
            messageEl.textContent = text;
            messageEl.className = 'message ' + type;
            messageEl.style.display = 'block';
            
            setTimeout(() => {
                messageEl.style.display = 'none';
            }, 3000);
        }

        function showDashboard() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('mainContainer').classList.add('wide');
            titleStage = '–ë–∞–Ω–∫';
            
            if (isAdmin) {
                document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'block');
            }
        }

        async function loadUserData() {
            document.getElementById('displayName').textContent = currentUsername;
            document.getElementById('usernameDisplay').textContent = currentUsername;

            const userSnapshot = await database.ref('users/' + currentUsername).once('value');
            const userData = userSnapshot.val();
            if (userData.displayName) {
                document.getElementById('displayName').textContent = userData.displayName;
            }

            loadCard();
            loadTransfers();
            loadNotifications();
            loadChats();
            
            database.ref('cards/' + currentUsername).on('value', (snapshot) => {
                if (snapshot.exists()) {
                    renderCard(snapshot.val());
                }
            });

            database.ref('transfers/' + currentUsername).on('value', (snapshot) => {
                renderTransfers(snapshot);
            });

            database.ref('notifications/' + currentUsername).on('value', (snapshot) => {
                renderNotifications(snapshot);
            });

            database.ref('chats').on('value', () => {
                loadChats();
            });
        }

        async function loadCard() {
            const snapshot = await database.ref('cards/' + currentUsername).once('value');
            if (snapshot.exists()) {
                renderCard(snapshot.val());
            } else {
                document.getElementById('cardContainer').innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üí≥</div>
                        <div>–£ –≤–∞—Å –Ω–µ—Ç –∫–∞—Ä—Ç—ã</div>
                        <button class="btn" style="margin-top: 15px; width: auto; padding: 10px 30px;" onclick="createCard()">–°–æ–∑–¥–∞—Ç—å –∫–∞—Ä—Ç—É</button>
                    </div>
                `;
            }
        }

        function renderCard(cardData) {
            const balanceDisplay = balanceVisible ? cardData.balance.toFixed(2) : '‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢';
            
            document.getElementById('cardContainer').innerHTML = `
                <div class="bank-card">
                    <div class="card-header">
                        <div class="card-logo">üí≥</div>
                        <div class="card-type">DEBIT</div>
                    </div>
                    <div class="card-chip"></div>
                    <div class="card-number">${cardData.number}</div>
                    <div class="card-footer">
                        <div class="card-info">
                            <div>
                                <div class="card-label">–í–ª–∞–¥–µ–ª–µ—Ü</div>
                                <div class="card-value">${cardData.holder}</div>
                            </div>
                            <div style="margin-top: 10px;">
                                <div class="card-label">–°—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è</div>
                                <div class="card-value">${cardData.expiry}</div>
                            </div>
                        </div>
                        <div class="card-balance">${balanceDisplay} √ê</div>
                    </div>
                </div>
                <div class="card-actions">
                    <button class="btn btn-primary" onclick="toggleBalance()">${balanceVisible ? 'üôà –°–∫—Ä—ã—Ç—å' : 'üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å'} –±–∞–ª–∞–Ω—Å</button>
                    <button class="btn btn-danger" onclick="deleteCard()">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç—É</button>
                </div>
            `;
        }

        function toggleBalance() {
            balanceVisible = !balanceVisible;
            loadCard();
        }

        async function createCard() {
            try {
                const cardNumber = generateCardNumber();
                await database.ref('cards/' + currentUsername).set({
                    number: cardNumber,
                    balance: 1000,
                    holder: currentUsername,
                    expiry: '12/28',
                    cvv: Math.floor(Math.random() * 900) + 100
                });

                await database.ref('cardHistory/' + currentUsername).push({
                    cardNumber: cardNumber,
                    createdAt: new Date().toISOString()
                });

                await database.ref('notifications/' + currentUsername).push({
                    type: 'success',
                    message: '–ö–∞—Ä—Ç–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–∞! –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å: 1000 √ê',
                    date: new Date().toISOString()
                });

                loadCard();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç—ã:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç—ã');
            }
        }

        async function deleteCard() {
            if (!confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–∞—Ä—Ç—É?')) return;

            try {
                await database.ref('cards/' + currentUsername).remove();
                
                await database.ref('notifications/' + currentUsername).push({
                    type: 'warning',
                    message: '–ö–∞—Ä—Ç–∞ —É–¥–∞–ª–µ–Ω–∞',
                    date: new Date().toISOString()
                });

                loadCard();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ä—Ç—ã:', error);
                alert('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–∞—Ä—Ç—ã');
            }
        }

        async function handleTransfer() {
            const recipientCard = document.getElementById('recipientCard').value.replace(/\s/g, '');
            const amount = parseFloat(document.getElementById('transferAmount').value);

            if (!recipientCard || !amount || amount <= 0) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ');
                return;
            }

            try {
                const senderCardSnapshot = await database.ref('cards/' + currentUsername).once('value');
                if (!senderCardSnapshot.exists()) {
                    alert('–£ –≤–∞—Å –Ω–µ—Ç –∫–∞—Ä—Ç—ã');
                    return;
                }

                const senderCard = senderCardSnapshot.val();
                
                if (senderCard.balance < amount) {
                    alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
                    return;
                }

                let recipientUsername = null;
                const allCardsSnapshot = await database.ref('cards').once('value');
                allCardsSnapshot.forEach((child) => {
                    if (child.val().number.replace(/\s/g, '') === recipientCard) {
                        recipientUsername = child.key;
                    }
                });

                if (!recipientUsername) {
                    alert('–ö–∞—Ä—Ç–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞');
                    return;
                }

                if (recipientUsername === currentUsername) {
                    alert('–ù–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–∞–º–æ–º—É —Å–µ–±–µ');
                    return;
                }

                await database.ref('cards/' + currentUsername + '/balance').set(senderCard.balance - amount);

                const recipientCardSnapshot = await database.ref('cards/' + recipientUsername).once('value');
                const recipientCardData = recipientCardSnapshot.val();
                await database.ref('cards/' + recipientUsername + '/balance').set(recipientCardData.balance + amount);

                const transferData = {
                    from: currentUsername,
                    to: recipientUsername,
                    amount: amount,
                    date: new Date().toISOString(),
                    type: 'outgoing',
                    fromCard: senderCard.number,
                    toCard: recipientCardData.number
                };

                await database.ref('transfers/' + currentUsername).push(transferData);
                await database.ref('transfers/' + recipientUsername).push({
                    ...transferData,
                    type: 'incoming'
                });

                await database.ref('notifications/' + recipientUsername).push({
                    type: 'success',
                    message: `–ü–æ–ª—É—á–µ–Ω –ø–µ—Ä–µ–≤–æ–¥ –æ—Ç ${currentUsername} –Ω–∞ —Å—É–º–º—É ${amount.toFixed(2)} √ê`,
                    date: new Date().toISOString()
                });

                document.getElementById('recipientCard').value = '';
                document.getElementById('transferAmount').value = '';
                
                alert('–ü–µ—Ä–µ–≤–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–µ—Ä–µ–≤–æ–¥–∞:', error);
                alert('–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–≤–æ–¥–∞');
            }
        }

        async function loadTransfers() {
            const snapshot = await database.ref('transfers/' + currentUsername).once('value');
            renderTransfers(snapshot);
        }

        function renderTransfers(snapshot) {
            // –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
        }

        async function loadNotifications() {
            const snapshot = await database.ref('notifications/' + currentUsername).once('value');
            renderNotifications(snapshot);
        }

        function renderNotifications(snapshot) {
            const container = document.getElementById('notificationsList');
            
            if (!snapshot.exists()) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîî</div>
                        <div>–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</div>
                    </div>
                `;
                return;
            }

            const notifications = [];
            snapshot.forEach((child) => {
                notifications.push({ id: child.key, ...child.val() });
            });

            notifications.reverse();

            let html = '';
            notifications.slice(0, 5).forEach(notif => {
                const date = new Date(notif.date).toLocaleString('ru-RU');
                html += `
                    <div class="notification-item ${notif.type}">
                        <div class="notification-message">${notif.message}</div>
                        <div class="notification-date">${date}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        async function loadChats() {
            const snapshot = await database.ref('users').once('value');
            const chatsList = document.getElementById('chatsList');
            const recipientSelect = document.getElementById('notificationRecipient');
            
            let html = '';
            let optionsHtml = '<option value="all">–í—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º</option>';
            
            snapshot.forEach((child) => {
                if (child.key !== currentUsername && child.key !== 'hohland') {
                    const userData = child.val();
                    html += `
                        <div class="chat-item" onclick="openChat('${child.key}')">
                            <div class="chat-item-header">
                                <div class="chat-item-name">${userData.displayName || child.key}</div>
                                <div class="chat-item-time">–û–Ω–ª–∞–π–Ω</div>
                            </div>
                            <div class="chat-item-preview">–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ</div>
                        </div>
                    `;
                    optionsHtml += `<option value="${child.key}">${userData.displayName || child.key}</option>`;
                }
            });

            if (!html) {
                html = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üë•</div>
                        <div>–ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —á–∞—Ç–æ–≤</div>
                    </div>
                `;
            }

            chatsList.innerHTML = html;
            if (recipientSelect) recipientSelect.innerHTML = optionsHtml;
        }

        function filterChats() {
            const searchValue = document.getElementById('chatSearch').value.toLowerCase();
            const items = document.querySelectorAll('.chat-item');
            
            items.forEach(item => {
                const name = item.querySelector('.chat-item-name').textContent.toLowerCase();
                item.style.display = name.includes(searchValue) ? 'block' : 'none';
            });
        }

        async function openChat(username) {
            currentChatUser = username;
            
            document.querySelectorAll('.chat-item').forEach(item => {
                item.classList.remove('active');
            });
            event.target.closest('.chat-item').classList.add('active');

            const userSnapshot = await database.ref('users/' + username).once('value');
            const userData = userSnapshot.val();
            
            document.getElementById('chatUserName').textContent = userData.displayName || username;
            document.getElementById('chatHeader').style.display = 'block';
            document.getElementById('chatInputContainer').style.display = 'flex';

            loadMessages();

            const chatId = [currentUsername, username].sort().join('_');
            database.ref('messages/' + chatId).on('value', () => {
                loadMessages();
            });
        }

        async function loadMessages() {
            const chatId = [currentUsername, currentChatUser].sort().join('_');
            const snapshot = await database.ref('messages/' + chatId).once('value');
            
            const messagesContainer = document.getElementById('chatMessages');
            
            if (!snapshot.exists()) {
                messagesContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üí¨</div>
                        <div>–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ</div>
                    </div>
                `;
                return;
            }

            const messages = [];
            snapshot.forEach((child) => {
                messages.push(child.val());
            });

            let html = '';
            messages.forEach(msg => {
                const time = new Date(msg.timestamp).toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
                const isSent = msg.sender === currentUsername;
                
                html += `
                    <div class="message ${isSent ? 'sent' : 'received'}">
                        <div class="message-text">${msg.text}</div>
                        <div class="message-time">${time}</div>
                    </div>
                `;
            });

            messagesContainer.innerHTML = html;
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        async function sendMessage() {
            const input = document.getElementById('messageInput');
            const text = input.value.trim();

            if (!text || !currentChatUser) return;

            const userSnapshot = await database.ref('users/' + currentUsername).once('value');
            const userData = userSnapshot.val();

            if (!userData.canDM && !isAdmin) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –ª–∏—á–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π');
                return;
            }

            try {
                const chatId = [currentUsername, currentChatUser].sort().join('_');
                
                await database.ref('messages/' + chatId).push({
                    sender: currentUsername,
                    text: text,
                    timestamp: new Date().toISOString()
                });

                await database.ref('chats/' + chatId).set({
                    users: [currentUsername, currentChatUser],
                    lastMessage: text,
                    timestamp: new Date().toISOString()
                });

                input.value = '';
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', error);
                alert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è');
            }
        }

        async function loadPosts() {
            const snapshot = await database.ref('posts').once('value');
            const postsContainer = document.getElementById('postsContainer');

            if (!snapshot.exists()) {
                postsContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        <div>–ù–µ—Ç –ø–æ—Å—Ç–æ–≤</div>
                    </div>
                `;
                return;
            }

            const posts = [];
            snapshot.forEach((child) => {
                posts.push({ id: child.key, ...child.val() });
            });

            posts.sort((a, b) => new Date(b.date) - new Date(a.date));

            let html = '';
            posts.forEach(post => {
                const date = new Date(post.date).toLocaleString('ru-RU');
                const canDelete = post.author === currentUsername || isAdmin;
                const liked = post.likes && post.likes[currentUsername];
                const likesCount = post.likes ? Object.keys(post.likes).length : 0;

                html += `
                    <div class="post-card">
                        <div class="post-header">
                            <div class="post-author">${post.authorName || post.author}</div>
                            <div class="post-date">${date}</div>
                        </div>
                        <div class="post-content">${post.content}</div>
                        <div class="post-actions">
                            <button class="post-action-btn ${liked ? 'liked' : ''}" onclick="toggleLike('${post.id}')">
                                ‚ù§Ô∏è ${likesCount}
                            </button>
                            ${canDelete ? `<button class="post-action-btn" onclick="deletePost('${post.id}')">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>` : ''}
                        </div>
                    </div>
                `;
            });

            postsContainer.innerHTML = html;
        }

        function toggleCreatePost() {
            const form = document.getElementById('createPostForm');
            form.style.display = form.style.display === 'none' ? 'block' : 'none';
        }

        async function createPost() {
            const content = document.getElementById('postContent').value.trim();

            if (!content) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –ø–æ—Å—Ç–∞');
                return;
            }

            const userSnapshot = await database.ref('users/' + currentUsername).once('value');
            const userData = userSnapshot.val();

            if (!userData.canPost && !isAdmin) {
                alert('–£ –≤–∞—Å –Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤');
                return;
            }

            try {
                await database.ref('posts').push({
                    author: currentUsername,
                    authorName: userData.displayName || currentUsername,
                    content: content,
                    date: new Date().toISOString(),
                    likes: {}
                });

                document.getElementById('postContent').value = '';
                toggleCreatePost();
                loadPosts();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞:', error);
                alert('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–∞');
            }
        }

        async function toggleLike(postId) {
            try {
                const snapshot = await database.ref('posts/' + postId + '/likes/' + currentUsername).once('value');
                
                if (snapshot.exists()) {
                    await database.ref('posts/' + postId + '/likes/' + currentUsername).remove();
                } else {
                    await database.ref('posts/' + postId + '/likes/' + currentUsername).set(true);
                }

                loadPosts();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ª–∞–π–∫–∞:', error);
            }
        }

        async function deletePost(postId) {
            if (!confirm('–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç?')) return;

            try {
                await database.ref('posts/' + postId).remove();
                loadPosts();
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞:', error);
                alert('–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ—Å—Ç–∞');
            }
        }

        async function updateDisplayName() {
            const newName = document.getElementById('newDisplayName').value.trim();

            if (!newName) {
                alert('–í–≤–µ–¥–∏—Ç–µ –∏–º—è');
                return;
            }

            try {
                await database.ref('users/' + currentUsername + '/displayName').set(newName);
                document.getElementById('displayName').textContent = newName;
                alert('–ò–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–æ!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–º–µ–Ω–∏:', error);
                alert('–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–º–µ–Ω–∏');
            }
        }

        async function changePassword() {
            const current = document.getElementById('currentPassword').value;
            const newPass = document.getElementById('newPassword').value;
            const confirm = document.getElementById('confirmPassword').value;

            if (!current || !newPass || !confirm) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            if (newPass !== confirm) {
                alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
                return;
            }

            if (newPass.length < 6) {
                alert('–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤');
                return;
            }

            try {
                const snapshot = await database.ref('users/' + currentUsername + '/password').once('value');
                
                if (snapshot.val() !== current) {
                    alert('–ù–µ–≤–µ—Ä–Ω—ã–π —Ç–µ–∫—É—â–∏–π –ø–∞—Ä–æ–ª—å');
                    return;
                }

                await database.ref('users/' + currentUsername + '/password').set(newPass);
                
                document.getElementById('currentPassword').value = '';
                document.getElementById('newPassword').value = '';
                document.getElementById('confirmPassword').value = '';
                
                alert('–ü–∞—Ä–æ–ª—å —É—Å–ø–µ—à–Ω–æ –∏–∑–º–µ–Ω–µ–Ω!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è:', error);
                alert('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è');
            }
        }

        async function loadLoginHistory() {
            const snapshot = await database.ref('loginHistory/' + currentUsername).once('value');
            const container = document.getElementById('loginHistoryContainer');

            if (!snapshot.exists()) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üîê</div>
                        <div>–ù–µ—Ç –∏—Å—Ç–æ—Ä–∏–∏ –≤—Ö–æ–¥–æ–≤</div>
                    </div>
                `;
                return;
            }

            const logins = [];
            snapshot.forEach((child) => {
                logins.push(child.val());
            });

            logins.reverse();

            let html = '';
            logins.forEach(login => {
                const date = new Date(login.timestamp).toLocaleString('ru-RU');
                html += `
                    <div class="login-history-item">
                        <div><strong>–î–∞—Ç–∞:</strong> ${date}</div>
                        <div style="margin-top: 5px; opacity: 0.7;"><strong>IP:</strong> ${login.ip}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        async function loadAllTransactions() {
            const snapshot = await database.ref('transfers/' + currentUsername).once('value');
            const container = document.getElementById('allTransactionsContainer');

            if (!snapshot.exists()) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üí∏</div>
                        <div>–ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</div>
                    </div>
                `;
                return;
            }

            const transfers = [];
            snapshot.forEach((child) => {
                transfers.push(child.val());
            });

            transfers.sort((a, b) => new Date(b.date) - new Date(a.date));

            let html = '';
            transfers.forEach(transfer => {
                const date = new Date(transfer.date).toLocaleString('ru-RU');
                const isPositive = transfer.type === 'incoming';
                const sign = isPositive ? '+' : '-';
                const partner = isPositive ? transfer.from : transfer.to;

                html += `
                    <div class="transaction-item">
                        <div class="transaction-header">
                            <div class="transaction-type">${isPositive ? '–ü–æ–ª—É—á–µ–Ω–æ –æ—Ç' : '–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –¥–ª—è'} ${partner}</div>
                            <div class="transaction-amount ${isPositive ? 'positive' : 'negative'}">${sign}${transfer.amount.toFixed(2)} √ê</div>
                        </div>
                        <div class="transaction-details">${date}</div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        async function loadAdminPanel() {
            const usersSnapshot = await database.ref('users').once('value');
            const cardsSnapshot = await database.ref('cards').once('value');
            const transfersSnapshot = await database.ref('transfers').once('value');

            let totalUsers = 0;
            let totalBalance = 0;
            let totalTransfers = 0;

            usersSnapshot.forEach(() => totalUsers++);
            cardsSnapshot.forEach((child) => {
                totalBalance += child.val().balance || 0;
            });
            transfersSnapshot.forEach((userTransfers) => {
                userTransfers.forEach(() => totalTransfers++);
            });

            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('totalBalance').textContent = totalBalance.toFixed(2) + ' √ê';
            document.getElementById('totalTransfers').textContent = Math.floor(totalTransfers / 2);

            const tbody = document.getElementById('usersTableBody');
            let html = '';

            usersSnapshot.forEach((child) => {
                if (child.key === 'hohland') return;

                const userData = child.val();
                const cardSnapshot = cardsSnapshot.child(child.key);
                const balance = cardSnapshot.exists() ? cardSnapshot.val().balance.toFixed(2) : '0.00';

                html += `
                    <tr>
                        <td>${child.key}</td>
                        <td>${userData.displayName || child.key}</td>
                        <td>${balance} √ê</td>
                        <td>
                            <button class="btn ${userData.canPost ? 'btn-success' : 'btn-danger'}" 
                                    onclick="toggleUserPermission('${child.key}', 'canPost', ${userData.canPost})"
                                    style="padding: 4px 8px; font-size: 11px; width: auto;">
                                ${userData.canPost ? '‚úì' : '‚úó'}
                            </button>
                        </td>
                        <td>
                            <button class="btn ${userData.canDM ? 'btn-success' : 'btn-danger'}" 
                                    onclick="toggleUserPermission('${child.key}', 'canDM', ${userData.canDM})"
                                    style="padding: 4px 8px; font-size: 11px; width: auto;">
                                ${userData.canDM ? '‚úì' : '‚úó'}
                            </button>
                        </td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn btn-primary" onclick="viewUserDetails('${child.key}')">–ò–Ω—Ñ–æ</button>
                                <button class="btn btn-secondary" onclick="changeUserBalance('${child.key}')">–ë–∞–ª–∞–Ω—Å</button>
                            </div>
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        async function changeUserBalance(username) {
            const amount = prompt('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è):');
            if (!amount) return;

            const amountNum = parseFloat(amount);
            if (isNaN(amountNum)) {
                alert('–ù–µ–≤–µ—Ä–Ω–∞—è —Å—É–º–º–∞');
                return;
            }

            try {
                const snapshot = await database.ref('cards/' + username).once('value');
                if (!snapshot.exists()) {
                    alert('–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –∫–∞—Ä—Ç—ã');
                    return;
                }

                const cardData = snapshot.val();
                const newBalance = cardData.balance + amountNum;

                if (newBalance < 0) {
                    alert('–ë–∞–ª–∞–Ω—Å –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º');
                    return;
                }

                await database.ref('cards/' + username + '/balance').set(newBalance);
                
                await database.ref('notifications/' + username).push({
                    type: amountNum > 0 ? 'success' : 'warning',
                    message: `–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä ${amountNum > 0 ? '–Ω–∞—á–∏—Å–ª–∏–ª' : '—Å–ø–∏—Å–∞–ª'} ${Math.abs(amountNum).toFixed(2)} √ê`,
                    date: new Date().toISOString()
                });

                alert('–û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞:', error);
                alert('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞');
            }
        }

        async function toggleUserPermission(username, permission, currentValue) {
            try {
                await database.ref('users/' + username + '/' + permission).set(!currentValue);
                
                const action = !currentValue ? '—Ä–∞–∑—Ä–µ—à–∏–ª' : '–∑–∞–ø—Ä–µ—Ç–∏–ª';
                const feature = permission === 'canPost' ? '—Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ—Å—Ç—ã' : '–æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è';
                
                await database.ref('notifications/' + username).push({
                    type: !currentValue ? 'success' : 'warning',
                    message: `–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä ${action} –≤–∞–º ${feature}`,
                    date: new Date().toISOString()
                });

                alert(`–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–æ`);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:', error);
                alert('–û—à–∏–±–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è');
            }
        }

        async function viewUserDetails(username) {
            try {
                const userSnapshot = await database.ref('users/' + username).once('value');
                const userData = userSnapshot.val();
                
                const cardSnapshot = await database.ref('cards/' + username).once('value');
                const cardData = cardSnapshot.val();

                const transfersSnapshot = await database.ref('transfers/' + username).once('value');
                const transfers = [];
                transfersSnapshot.forEach((child) => {
                    transfers.push(child.val());
                });

                const loginHistorySnapshot = await database.ref('loginHistory/' + username).once('value');
                const logins = [];
                loginHistorySnapshot.forEach((child) => {
                    logins.push(child.val());
                });

                const cardHistorySnapshot = await database.ref('cardHistory/' + username).once('value');
                const cardHistory = [];
                cardHistorySnapshot.forEach((child) => {
                    cardHistory.push(child.val());
                });

                let details = `–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${userData.displayName || username}
–õ–æ–≥–∏–Ω: ${username}
–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ${new Date(userData.createdAt).toLocaleString('ru-RU')}

–ö–∞—Ä—Ç–∞: ${cardData ? cardData.number : '–ù–µ—Ç –∫–∞—Ä—Ç—ã'}
–ë–∞–ª–∞–Ω—Å: ${cardData ? cardData.balance.toFixed(2) + ' √ê' : 'N/A'}

–í—Å–µ–≥–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: ${transfers.length}
–í—Å–µ–≥–æ –≤—Ö–æ–¥–æ–≤: ${logins.length}
–°–æ–∑–¥–∞–Ω–æ –∫–∞—Ä—Ç: ${cardHistory.length}

–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥: ${logins.length > 0 ? new Date(logins[logins.length - 1].timestamp).toLocaleString('ru-RU') : '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}`;

                alert(details);
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
                alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
            }
        }

        async function sendNotification() {
            const type = document.getElementById('notificationType').value;
            const recipient = document.getElementById('notificationRecipient').value;
            const text = document.getElementById('notificationText').value.trim();

            if (!text) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è');
                return;
            }

            try {
                const notification = {
                    type: type,
                    message: text,
                    date: new Date().toISOString()
                };

                if (recipient === 'all') {
                    const snapshot = await database.ref('users').once('value');
                    const updates = {};
                    
                    snapshot.forEach((childSnapshot) => {
                        if (childSnapshot.key !== 'hohland') {
                            const key = database.ref('notifications/' + childSnapshot.key).push().key;
                            updates['notifications/' + childSnapshot.key + '/' + key] = notification;
                        }
                    });

                    await database.ref().update(updates);
                } else {
                    await database.ref('notifications/' + recipient).push(notification);
                }

                document.getElementById('notificationText').value = '';
                alert('–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:', error);
                alert('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è');
            }
        }

        function switchSection(section) {
            currentSection = section;
            
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.querySelectorAll('.dashboard-content').forEach(content => {
                content.classList.remove('active');
            });
            
            const sectionMap = {
                'bank': 'bankSection',
                'messenger': 'messengerSection',
                'posts': 'postsSection',
                'settings': 'settingsSection',
                'admin': 'adminSection'
            };
            
            document.getElementById(sectionMap[section]).classList.add('active');
            
            const titleMap = {
                'bank': '–ë–∞–Ω–∫',
                'messenger': '–ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä',
                'posts': '–ü–æ—Å—Ç—ã',
                'settings': '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
                'admin': '–ê–¥–º–∏–Ω'
            };
            titleStage = titleMap[section];
            
            if (section === 'posts') {
                loadPosts();
            } else if (section === 'settings') {
                loadLoginHistory();
                loadAllTransactions();
            } else if (section === 'admin' && isAdmin) {
                loadAdminPanel();
            }
        }

        function handleLogout() {
            database.ref('cards/' + currentUsername).off();
            database.ref('transfers/' + currentUsername).off();
            database.ref('notifications/' + currentUsername).off();
            database.ref('chats').off();
            database.ref('messages').off();
            database.ref('posts').off();

            localStorage.removeItem('hohlgramSession');
            
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('dashboard').style.display = 'none';
            document.getElementById('mainContainer').classList.remove('wide');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('message').style.display = 'none';
            
            currentUsername = '';
            isAdmin = false;
            balanceVisible = false;
            titleStage = '–í—Ö–æ–¥';
            
            document.querySelectorAll('.admin-only').forEach(el => el.style.display = 'none');
        }

        document.addEventListener('DOMContentLoaded', function() {
            const cardInput = document.getElementById('recipientCard');
            if (cardInput) {
                cardInput.addEventListener('input', function(e) {
                    let value = e.target.value.replace(/\s/g, '');
                    let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
                    e.target.value = formattedValue;
                });
            }

            const session = localStorage.getItem('hohlgramSession');
            if (session) {
                const sessionData = JSON.parse(session);
                const hoursPassed = (Date.now() - sessionData.timestamp) / (1000 * 60 * 60);
                
                if (hoursPassed < 24) {
                    document.getElementById('username').value = sessionData.username;
                }
            }

            const messageInput = document.getElementById('messageInput');
            if (messageInput) {
                messageInput.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        sendMessage();
                    }
                });
            }
        });

        database.ref('users/hohland').once('value').then((snapshot) => {
            if (!snapshot.exists()) {
                database.ref('users/hohland').set({
                    password: 'ZMKBSCw9iQ7m98YoGFNn',
                    displayName: 'Administrator',
                    createdAt: new Date().toISOString(),
                    isAdmin: true
                });
            }
        });
    </script>
</body>
</html>
